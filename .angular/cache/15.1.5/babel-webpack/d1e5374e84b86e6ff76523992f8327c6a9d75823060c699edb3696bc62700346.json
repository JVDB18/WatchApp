{"ast":null,"code":"import { TraktService } from 'src/app/trakt.service';\nimport { ActivatedRoute, ParamMap } from '@angular/router';\nimport { TmdbService } from 'src/app/tmdb.service';\nimport { DomSanitizer } from '@angular/platform-browser';\nimport { Subscription, Subject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/trakt.service\";\nimport * as i2 from \"src/app/tmdb.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/platform-browser\";\nimport * as i5 from \"@angular/common\";\nfunction SeasonsComponent_li_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\")(1, \"a\", 11);\n    i0.ɵɵtext(2);\n    i0.ɵɵelement(3, \"br\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const episode_r7 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate1(\"routerLink\", \"episode/\", episode_r7.episode_number, \"\");\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\" Episode \", episode_r7.episode_number, \": \", episode_r7.name, \" \");\n  }\n}\nfunction SeasonsComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 6);\n    i0.ɵɵelement(1, \"iframe\", 12);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"src\", ctx_r1.safeURL, i0.ɵɵsanitizeResourceUrl);\n  }\n}\nfunction SeasonsComponent_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"div\", 13);\n  }\n}\nfunction SeasonsComponent_div_8_img_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 16);\n  }\n  if (rf & 2) {\n    const ctx_r9 = i0.ɵɵnextContext(2);\n    i0.ɵɵpropertyInterpolate(\"src\", ctx_r9.posterUrl, i0.ɵɵsanitizeUrl);\n  }\n}\nfunction SeasonsComponent_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 14);\n    i0.ɵɵtemplate(1, SeasonsComponent_div_8_img_1_Template, 1, 1, \"img\", 15);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.posterUrl && ctx_r3.isDisplay === true);\n  }\n}\nfunction SeasonsComponent_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"div\", 17);\n  }\n}\nfunction SeasonsComponent_div_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18)(1, \"h2\");\n    i0.ɵɵtext(2, \"Season Summary\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction SeasonsComponent_div_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18)(1, \"h2\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"p\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", ctx_r6.seasonSummary.name, \" Summary\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r6.seasonSummary.overview);\n  }\n}\nexport let SeasonsComponent = /*#__PURE__*/(() => {\n  class SeasonsComponent {\n    constructor(traktService, tmdbService, route, _sanitizer) {\n      this.traktService = traktService;\n      this.tmdbService = tmdbService;\n      this.route = route;\n      this._sanitizer = _sanitizer;\n      this.subscription = new Subscription();\n      /* mettre un subject sur le display boolean pour éviter le bug du poster */\n      this.display = new Subject();\n      this.noTrailer = new Subject();\n      this.formattrakt = \"shows\";\n      this.format = \"tv\";\n    }\n    ngOnInit() {\n      this.getSeason();\n      this.display.subscribe(res => this.isDisplay = res);\n      this.noTrailer.subscribe(res => this.isTrailer = res);\n    }\n    ngOnDestroy() {\n      this.subscription.unsubscribe();\n    }\n    getSeason() {\n      this.subscription.add(this.route.paramMap.subscribe(params => {\n        this.number = params.get('number');\n        this.id = params.get('id');\n        console.log(this.number);\n        console.log(this.id);\n        this.tmdbService.getSeason(this.id, this.number).subscribe(res => {\n          this.seasonSummary = res;\n          console.log(this.seasonSummary);\n          if (this.seasonSummary.poster_path === undefined || this.seasonSummary.poster_path === null) {\n            this.display.next(false);\n          } else {\n            this.posterUrl = `${this.tmdbService.config.images.base_url}w200${this.seasonSummary.poster_path}`;\n            this.display.next(true);\n          }\n        });\n        let options = `${this.format}/${this.id}`;\n        let options2 = `season/${this.number}`;\n        this.tmdbService.getTrailer(options, options2).subscribe(res => {\n          this.trailer = res;\n          if (this.trailer.results.length !== 0) {\n            this.path = `https://www.youtube.com/embed/${this.trailer.results[0].key}`;\n            this.safeURL = this._sanitizer.bypassSecurityTrustResourceUrl(this.path);\n            this.noTrailer.next(true);\n          } else {\n            this.noTrailer.next(false);\n          }\n        });\n      }));\n      //ATTENTION DANS LES EPISODES L'ID RENVOYER A TMDB N EST PAS LE BON! FAIRE PASSER L'ID DE TRAKT DANS LES PARAMS D URL APRES L ID DE TMDB DANS LE ROUTING ENFANT DES SAISONS\n    }\n  }\n\n  SeasonsComponent.ɵfac = function SeasonsComponent_Factory(t) {\n    return new (t || SeasonsComponent)(i0.ɵɵdirectiveInject(i1.TraktService), i0.ɵɵdirectiveInject(i2.TmdbService), i0.ɵɵdirectiveInject(i3.ActivatedRoute), i0.ɵɵdirectiveInject(i4.DomSanitizer));\n  };\n  SeasonsComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: SeasonsComponent,\n    selectors: [[\"app-seasons\"]],\n    decls: 13,\n    vars: 7,\n    consts: [[1, \"season-container\"], [1, \"episodes\"], [1, \"episode-nav\"], [4, \"ngFor\", \"ngForOf\"], [1, \"season-details-container\"], [\"class\", \"season-trailer-container\", 4, \"ngIf\"], [1, \"season-trailer-container\"], [\"class\", \"noTrailer\", 4, \"ngIf\"], [\"class\", \"season-poster\", 4, \"ngIf\"], [\"class\", \"season-no-poster\", 4, \"ngIf\"], [\"class\", \"season-overview\", 4, \"ngIf\"], [3, \"routerLink\"], [\"width\", \"560\", \"height\", \"315\", \"frameborder\", \"0\", \"allow\", \"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\", \"allowfullscreen\", \"\", 3, \"src\"], [1, \"noTrailer\"], [1, \"season-poster\"], [3, \"src\", 4, \"ngIf\"], [3, \"src\"], [1, \"season-no-poster\"], [1, \"season-overview\"]],\n    template: function SeasonsComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"nav\", 2);\n        i0.ɵɵtemplate(3, SeasonsComponent_li_3_Template, 4, 3, \"li\", 3);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(4, \"div\", 4);\n        i0.ɵɵtemplate(5, SeasonsComponent_div_5_Template, 2, 1, \"div\", 5);\n        i0.ɵɵelementStart(6, \"div\", 6);\n        i0.ɵɵtemplate(7, SeasonsComponent_div_7_Template, 1, 0, \"div\", 7);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(8, SeasonsComponent_div_8_Template, 2, 1, \"div\", 8);\n        i0.ɵɵtemplate(9, SeasonsComponent_div_9_Template, 1, 0, \"div\", 9);\n        i0.ɵɵtemplate(10, SeasonsComponent_div_10_Template, 3, 0, \"div\", 10);\n        i0.ɵɵtemplate(11, SeasonsComponent_div_11_Template, 5, 2, \"div\", 10);\n        i0.ɵɵelement(12, \"router-outlet\");\n        i0.ɵɵelementEnd()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngForOf\", ctx.seasonSummary.episodes);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.trailer.results.length !== 0);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.isTrailer === false);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.seasonSummary.poster_path !== undefined || ctx.seasonSummary.poster_path !== null);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.isDisplay === false);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.seasonSummary.overview === \"\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.seasonSummary.overview !== \"\");\n      }\n    },\n    dependencies: [i5.NgForOf, i5.NgIf, i3.RouterOutlet, i3.RouterLink]\n  });\n  return SeasonsComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}